<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRGOALS Kanalları</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            background-color: #f8f9fa;
        }
        #video-player {
            width: 100%;
            height: 30vh;
            background-color: black;
        }
        h1 {
            margin: 20px 0;
            text-align: center;
        }
        #channel-list {
            width: 100%;
            max-width: 600px;
            height: 50vh;
            overflow-y: scroll;
            border: 1px solid #ccc;
            background-color: #fff;
            padding: 10px;
        }
        .channel-item {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            cursor: pointer;
        }
        .channel-item:hover {
            background-color: #f1f1f1;
        }
        #export-btn {
            margin: 20px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        #export-btn:hover {
            background-color: #0056b3;
        }
        #modal, #export-modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .modal-content, .export-modal-content {
            background-color: white;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 400px;
            text-align: center;
        }
        .modal-buttons, .export-buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .modal-buttons button, .export-buttons button {
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        .play-btn {
            background-color: #28a745;
            color: white;
        }
        .copy-btn {
            background-color: #ffc107;
            color: black;
        }
        .rename-btn {
            background-color: #17a2b8;
            color: white;
        }
        .cancel-btn, .confirm-btn {
            background-color: #dc3545;
            color: white;
        }
        .select-all-btn {
            background-color: #007bff;
            color: white;
        }
        .select-all-btn.selected {
            background-color: #28a745;
        }
    </style>
</head>
<body>
    <video id="video-player" controls></video>
    <h1>TRGOALS KANALLARI</h1>
    <div id="channel-list"></div>
    <button id="export-btn">Dışa Aktar</button>

    <div id="modal">
        <div class="modal-content">
            <p id="modal-title"></p>
            <div class="modal-buttons">
                <button class="play-btn">Oynat</button>
                <button class="copy-btn">Kopyala</button>
                <button class="rename-btn">İsim Ver</button>
                <button class="cancel-btn">İptal</button>
            </div>
        </div>
    </div>

    <div id="export-modal">
        <div class="export-modal-content">
            <p>Seçenekler:</p>
            <div id="export-options"></div>
            <div class="export-buttons">
                <button class="confirm-btn">Dışa Aktar</button>
                <button class="cancel-btn">İptal</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async function () {
            const proxyUrl = 'https://corsvip.egotv3.site/?apiurl=';
            const mainUrl = 'https://eniyiyayinci.github.io/redirect/index.html';
            const player = document.getElementById('video-player');
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modal-title');
            const exportModal = document.getElementById('export-modal');
            const exportOptions = document.getElementById('export-options');
            const exportBtn = document.getElementById('export-btn');
            const selectAllBtn = document.createElement('button');
            selectAllBtn.className = 'select-all-btn';
            selectAllBtn.textContent = 'Tümünü Seç';
            exportModal.querySelector('.export-buttons').appendChild(selectAllBtn);
            let selectedChannelUrl = '';

            try {
                const mainResponse = await fetch(proxyUrl + mainUrl);
                const mainText = await mainResponse.text();
                const trGoalsUrlMatch = mainText.match(/https:\/\/trgoals\d+\.xyz\//);
                if (!trGoalsUrlMatch) throw new Error('TRGOALS URL not found');
                const trGoalsUrl = trGoalsUrlMatch[0];

                const channelResponse = await fetch(proxyUrl + trGoalsUrl + 'channel.html');
                const channelText = await channelResponse.text();
                const baseUrlMatch = channelText.match(/https:\/\/m3u8\.herkesgiderbizkaliriz\.workers\.dev\//);
                if (!baseUrlMatch) throw new Error('Base URL not found');
                const baseUrl = baseUrlMatch[0];

                const sampleUrl = baseUrl + 'yayinzirve.m3u8';
                const sampleResponse = await fetch(proxyUrl + sampleUrl);
                const sampleText = await sampleResponse.text();
                const avifUrlMatch = sampleText.match(/https:\/\/trgoalsdencalintaktik\.global\.ssl\.fastly\.net\/[^\s]+\.avif/);
                if (!avifUrlMatch) throw new Error('.avif URL not found');
                const avifBaseUrl = avifUrlMatch[0].replace(/[^\/]+\.avif$/, '');

                const channelIds = [
                    'yayinzirve.m3u8', 'yayinstar.m3u8', 'yayin1.m3u8', 'yayinb2.m3u8',
                    'yayinb3.m3u8', 'yayinb4.m3u8', 'yayinb5.m3u8', 'yayinbm1.m3u8',
                    'yayinbm2.m3u8', 'yayinss.m3u8', 'yayinss2.m3u8', 'yayinssp2.m3u8',
                    'yayint1.m3u8', 'yayint2.m3u8', 'yayint3.m3u8', 'yayinsmarts.m3u8',
                    'yayinsms2.m3u8', 'yayintrtspor.m3u8', 'yayintrtspor2.m3u8', 'yayinas.m3u8',
                    'yayinatv.m3u8', 'yayintv8.m3u8', 'yayintv85.m3u8', 'yayinnbatv.m3u8',
                    'yayinex1.m3u8', 'yayinex2.m3u8', 'yayinex3.m3u8', 'yayinex4.m3u8',
                    'yayinex5.m3u8', 'yayinex6.m3u8', 'yayinex7.m3u8', 'yayinex8.m3u8'
                ];

                const channelList = document.getElementById('channel-list');

                channelIds.forEach(id => {
                    const channelUrl = avifBaseUrl + id;
                    const channelName = id.split('.')[0];
                    const channelItem = document.createElement('div');
                    channelItem.className = 'channel-item';
                    channelItem.textContent = channelName;
                    channelItem.dataset.url = channelUrl;
                    channelItem.addEventListener('click', function () {
                        selectedChannelUrl = channelUrl;
                        modalTitle.textContent = channelName;
                        modal.style.display = 'flex';
                    });
                    channelList.appendChild(channelItem);
                });

                document.querySelector('.play-btn').addEventListener('click', () => {
                    player.src = selectedChannelUrl;
                    modal.style.display = 'none';
                });

                document.querySelector('.copy-btn').addEventListener('click', () => {
                    navigator.clipboard.writeText(selectedChannelUrl).then(() => {
                        alert('URL panoya kopyalandı');
                    });
                    modal.style.display = 'none';
                });

                document.querySelector('.rename-btn').addEventListener('click', () => {
                    const newName = prompt('Yeni isim girin:', modalTitle.textContent);
                    if (newName) {
                        document.querySelector(`.channel-item[data-url="${selectedChannelUrl}"]`).textContent = newName;
                    }
                    modal.style.display = 'none';
                });

                document.querySelector('.cancel-btn').addEventListener('click', () => {
                    modal.style.display = 'none';
                });

                exportBtn.addEventListener('click', () => {
                    exportOptions.innerHTML = '';
                    channelIds.forEach(id => {
                        const channelUrl = avifBaseUrl + id;
                        const channelName = document.querySelector(`.channel-item[data-url="${channelUrl}"]`).textContent;
                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.value = channelUrl;
                        const label = document.createElement('label');
                        label.textContent = channelName;
                        label.style.marginLeft = '8px';
                        const div = document.createElement('div');
                        div.appendChild(checkbox);
                        div.appendChild(label);
                        exportOptions.appendChild(div);
                    });
                    exportModal.style.display = 'flex';
                });

                document.querySelector('.confirm-btn').addEventListener('click', () => {
                    const selectedUrls = Array.from(exportOptions.querySelectorAll('input:checked')).map(input => input.value);
                    const m3uContent = selectedUrls.map(url => `#EXTINF:-1,${document.querySelector(`.channel-item[data-url="${url}"]`).textContent}\n${url}`).join('\n');
                    navigator.clipboard.writeText(m3uContent).then(() => {
                        alert('M3U içeriini panoya kopyalandı');
                    });
                    exportModal.style.display = 'none';
                });

                document.querySelector('#export-modal .cancel-btn').addEventListener('click', () => {
                    exportModal.style.display = 'none';
                });

                selectAllBtn.addEventListener('click', () => {
                    const checkboxes = exportOptions.querySelectorAll('input[type="checkbox"]');
                    const isChecked = !checkboxes[0].checked;
                    checkboxes.forEach(checkbox => {
                        checkbox.checked = isChecked;
                    });
                    selectAllBtn.textContent = isChecked ? 'Seçimleri Temizle' : 'Tümünü Seç';
                    selectAllBtn.classList.toggle('selected', isChecked);
                });

            } catch (error) {
                console.error('Error fetching data:', error);
            }
        });
    </script>
</body>
</html>


